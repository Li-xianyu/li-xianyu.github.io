*{
	-webkit-tap-highlight-color: transparent;
	-webkit-user-select: none;
	user-select: none;
}

body{
	margin:0;
	padding:0;
	height:100vh;
	display:flex;
	justify-content:center;
	align-items:center;
	background:var(--bg-color);
	color:var(--text-color);
	transition: background var(--transition-speed);
}

body.game-page{
	flex-direction:column;
	gap:14px;
	padding:20px 12px;
	height:auto;
	min-height:100vh;
}

/* ===== 菜单 ===== */
.menu-container{
	position:fixed;
	top:50%;
	left:50%;
	transform:translate(-50%,-50%);
	text-align:center;
	z-index:10;
}

.game-title{
	color:var(--text-color);
	font-size:2.5rem;
	margin-bottom:5rem;
	text-shadow:0 2px 4px var(--shadow-color);
	letter-spacing:1px;
}

.menu-buttons{
	display:flex;
	flex-direction:column;
	gap:1.5rem;
}

.menu-btn{
	width:100%;
	padding:12px clamp(10px,5vw,30px);
	box-sizing:border-box;
	background:var(--black-cell);
	color:#fff;
	border:none;
	border-radius:var(--cell-radius);
	cursor:pointer;
	font-size:1.1rem;
	transition: transform var(--transition-speed), background var(--transition-speed), box-shadow var(--transition-speed);
	box-shadow:0 4px 12px var(--shadow-color);
	display:flex;
	align-items:center;
	justify-content:center;
	gap:8px;
}

.menu-btn:hover{
	transform:scale(var(--hover-scale));
	background:var(--current-color);
	box-shadow:0 6px 16px var(--shadow-color);
}

.menu-btn:active{
	transform:scale(.98);
}

/* ===== 棋盘 ===== */
.board{
	width:70vmin;
	height:70vmin;
	max-width:400px;
	max-height:400px;
	display:grid;
	grid-template-columns:repeat(10,1fr);
	gap:3px;
	padding:12px;
	background:var(--board-color);
	border-radius:12px;
	box-shadow:0 4px 20px var(--shadow-color);
	transition: background var(--transition-speed), box-shadow var(--transition-speed);
}

/* ===== 回合 + 按钮 ===== */
.round-info{
	font-size:16px;
	font-weight:700;
	letter-spacing:.5px;
	color:var(--text-color);
	opacity:.9;
	margin-top:4px;
}

.controls{
	display:flex;
	gap:14px;
	justify-content:center;
	align-items:center;
}

.dice-btn{
	width:64px;
	height:64px;
	border-radius:999px;
	border:none;
	color:#fff;
	font-weight:700;
	letter-spacing:.5px;
	cursor:pointer;
	box-shadow:0 8px 22px rgba(0,0,0,.22);
	transition: transform .15s ease, filter .15s ease, box-shadow .15s ease, opacity .15s ease;
}

.dice-btn:hover{
	transform:scale(1.05);
	filter:brightness(1.05);
	box-shadow:0 10px 26px rgba(0,0,0,.28);
}

.dice-btn:active{ transform:scale(.98); }
.dice-btn.master{
	background: var(--master-color);
}

.dice-btn.passive{
	background: var(--passive-color);
}
.dice-btn:disabled{
	opacity:.5;
	cursor:not-allowed;
	transform:none;
	filter:none;
	box-shadow:none;
}

@media (max-width:420px){
	.dice-btn{ width:58px; height:58px; font-size:13px; }
	.controls{ gap:12px; }
	.round-info{ font-size:15px; }
}

/* ===== 任务面板：避免“边框跳变” ===== */
.task-panel{
	width:min(92vw,520px);
	margin:14px auto 0;
	padding:12px;
	border-radius:14px;

	background:var(--bg-color);
	border:1px solid transparent;

	backdrop-filter:blur(10px);
	-webkit-backdrop-filter:blur(10px);

	display:grid;
	gap:10px;
	align-self:center;
	transition: background var(--transition-speed), box-shadow var(--transition-speed);
	position:relative;
	box-shadow:0 6px 20px rgba(0,0,0,.06);
}

.task-panel::before{
	content:"";
	position:absolute;
	inset:0;
	border-radius:inherit;
	border:1px solid var(--cell-color);
	opacity:.7;
	pointer-events:none;
	transition: opacity var(--transition-speed), border-color var(--transition-speed);
}

.task-block{
	padding:10px 12px;
	border-radius:12px;
	background:var(--bg-color);
	border:1px solid transparent;

	transition: background var(--transition-speed), box-shadow var(--transition-speed);
	position:relative;
	box-shadow:0 4px 14px rgba(0,0,0,.05);
}

.task-block::before{
	content:"";
	position:absolute;
	inset:0;
	border-radius:inherit;
	border:1px solid var(--cell-color);
	opacity:.55;
	pointer-events:none;
	transition: opacity var(--transition-speed), border-color var(--transition-speed);
}

.task-title{
	font-size:12px;
	opacity:.7;
	margin-bottom:6px;
}

.task-content{
	font-size:15px;
	font-weight:600;
	word-break:break-word;
	text-align:center;
}

#taskMaster{ color:#b42318; }
#taskPassive{ color:#1d4ed8; }

/* ===== 格子 ===== */
.cell{
	background:var(--cell-color);
	border-radius:var(--cell-radius);
	display:flex;
	align-items:stretch;
	justify-content:stretch;
	font-size:12px;
	color:var(--text-color);
	transition: transform var(--transition-speed), background var(--transition-speed);
}

/* 主/被当前位置 */
.master-location{
	outline:2px solid var(--master-color);
	box-shadow:0 0 0 4px var(--master-glow);
}

.passive-location{
	outline:2px solid var(--passive-color);
	box-shadow:0 0 0 4px var(--passive-glow);
}

.black{
	background:var(--black-cell);
	cursor:pointer;
	position:relative;
	overflow:hidden;
}

.black::after{
	content:'';
	position:absolute;
	inset:0;
	background:radial-gradient(circle at center, rgba(255,255,255,0.12) 0%, transparent 60%);
	pointer-events:none;
}

.start{
	background:var(--start-cell);
	cursor:pointer;
	font-weight:700;
}

.end{
	background:var(--end-cell);
	cursor:pointer;
	font-weight:700;
}

.black:hover,.start:hover,.end:hover{
	transform:scale(var(--hover-scale));
	z-index:2;
	box-shadow:0 2px 8px var(--shadow-color);
}



/* ===== 动效 ===== */
@keyframes pulse{
	0%{ transform:scale(1); opacity:1; }
	50%{ transform:scale(1.08); opacity:.9; box-shadow:0 0 20px var(--current-glow); }
	100%{ transform:scale(1); opacity:1; }
}

@keyframes movingGlow{
	0%{ box-shadow:0 0 5px var(--moving-glow), inset 0 0 10px var(--moving-glow); }
	50%{ box-shadow:0 0 15px var(--moving-glow), inset 0 0 15px var(--moving-glow); }
	100%{ box-shadow:0 0 5px var(--moving-glow), inset 0 0 10px var(--moving-glow); }
}

.current-location{
	background:var(--current-color) !important;
	animation:pulse 1s ease-in-out infinite;
	box-shadow:0 0 12px var(--current-glow);
	z-index:2;
}

.moving{
	position:relative;
	transform:scale(1.05);
	z-index:3;
	transition: all .3s cubic-bezier(0.22,0.61,0.36,1);
	animation:movingGlow 1s ease-in-out infinite;
}

/* ===== 骰子弹窗 ===== */
@keyframes dicePopIn{
	0%{ transform:translate(-50%,-50%) scale(.8); opacity:0; }
	100%{ transform:translate(-50%,-50%) scale(1); opacity:1; }
}

@keyframes diceOverlayIn{
	0%{ opacity:0; }
	100%{ opacity:1; }
}

.dice-overlay{
	position:fixed;
	inset:0;
	background: rgba(0,0,0,.32);
	backdrop-filter: blur(6px);
	-webkit-backdrop-filter: blur(6px);
	z-index:9998;
	animation:diceOverlayIn .12s ease;
}

/* 背景冻结（可选，但很爽） */
body.dice-focus .board,
body.dice-focus .controls,
body.dice-focus .task-panel{
	filter: blur(1.5px) saturate(.9) brightness(.92);
	transform: scale(.992);
	transition: filter .12s ease, transform .12s ease;
	pointer-events:none; /* 骰子期间别点到棋盘 */
}

.popup{
	position:fixed;
	left:50%;
	top:50%;
	transform:translate(-50%,-50%);
	width:140px;
	height:140px;
	background:var(--board-color);
	border:2px solid var(--black-cell);
	border-radius:14px;
	z-index:9999;
	box-shadow: 0 18px 60px rgba(0,0,0,.22);
	display:flex;
	align-items:center;
	justify-content:center;
	backdrop-filter:blur(4px);
	z-index:9999;
	animation:dicePopIn .3s cubic-bezier(0.34,1.56,0.64,1);
}

.dice{
	position:relative;
	width:90px;
	height:90px;
	display:grid;
	grid-template-columns:repeat(3,1fr);
	grid-template-rows:repeat(3,1fr);
	background:var(--cell-color);
	border:2px solid var(--black-cell);
	border-radius:12px;
	padding:12px;
	box-shadow: inset 0 2px 4px rgba(255,255,255,0.1), 0 2px 8px var(--shadow-color);
}

/* .dice::after{
	content: attr(data-point);
	position:absolute;
	bottom:-28px;
	left:50%;
	transform:translateX(-50%);
	color:var(--text-color);
	font-weight:700;
	font-size:18px;
	opacity:.8;
} */

.dot{
	width:16px;
	height:16px;
	border-radius:50%;
	opacity:0;
	place-self:center;
	position:relative;
	background: var(--text-color);
	box-shadow:
		inset 0 1px 2px rgba(255,255,255,.18),
		inset 0 -2px 3px rgba(0,0,0,.28),
		0 1px 2px rgba(0,0,0,.15);
}

.dot::after{
	content:"";
	position:absolute;
	left:3px;
	top:3px;
	width:6px;
	height:6px;
	border-radius:50%;
	background: rgba(255,255,255,.45);
	filter: blur(.2px);
}

/* 9个点布局 */
.dot:nth-child(1){ grid-area:1/1; }
.dot:nth-child(2){ grid-area:1/2; }
.dot:nth-child(3){ grid-area:1/3; }
.dot:nth-child(4){ grid-area:2/1; }
.dot:nth-child(5){ grid-area:2/2; }
.dot:nth-child(6){ grid-area:2/3; }
.dot:nth-child(7){ grid-area:3/1; }
.dot:nth-child(8){ grid-area:3/2; }
.dot:nth-child(9){ grid-area:3/3; }

/* 点数显隐 */
[data-point="1"] .dot:nth-child(5){ opacity:1; }
[data-point="2"] .dot:nth-child(1),
[data-point="2"] .dot:nth-child(9){ opacity:1; }
[data-point="3"] .dot:nth-child(1),
[data-point="3"] .dot:nth-child(5),
[data-point="3"] .dot:nth-child(9){ opacity:1; }
[data-point="4"] .dot:nth-child(1),
[data-point="4"] .dot:nth-child(3),
[data-point="4"] .dot:nth-child(7),
[data-point="4"] .dot:nth-child(9){ opacity:1; }
[data-point="5"] .dot:nth-child(1),
[data-point="5"] .dot:nth-child(3),
[data-point="5"] .dot:nth-child(5),
[data-point="5"] .dot:nth-child(7),
[data-point="5"] .dot:nth-child(9){ opacity:1; }
[data-point="6"] .dot:nth-child(1),
[data-point="6"] .dot:nth-child(3),
[data-point="6"] .dot:nth-child(4),
[data-point="6"] .dot:nth-child(6),
[data-point="6"] .dot:nth-child(7),
[data-point="6"] .dot:nth-child(9){ opacity:1; }

/* ===== 通用遮罩 ===== */
.punishment-overlay{
	position:fixed;
	inset:0;
	background:var(--overlay-bg);
	backdrop-filter:blur(16px);
	-webkit-backdrop-filter:blur(16px);
	z-index:999;
	display:flex;
	justify-content:center;
	align-items:center;
	padding:16px;
}

/* ===== 关键：弹窗改成“头固定 + 内容滚动 + 底固定按钮” ===== */
@keyframes popIn{
	0%{ transform:scale(.92); opacity:0; }
	100%{ transform:scale(1); opacity:1; }
}

.punishment-dialog{
	width:min(92vw, 520px);
	max-height:min(86vh, 760px);
    max-height: 90%;
    max-width: 280px; 
	background:var(--dialog-bg);
	border-radius:14px;
	box-shadow:0 12px 48px rgba(0,0,0,0.12);
	backdrop-filter:blur(24px);
	-webkit-backdrop-filter:blur(24px);
	border:1px solid var(--dialog-border);
	animation: popIn .3s cubic-bezier(0.22,0.61,0.36,1);
    /* padding-bottom: 10px; */
	display:flex;
	flex-direction:column;
	overflow:hidden;
}

/* 标题固定（你之前用 punishment-title，继续兼容） */
.punishment-title{
	margin:0;
	padding:14px 16px;
	color:var(--dialog-text);
	font-size:18px;
	font-weight:700;
	letter-spacing:.4px;
	border-bottom:1px solid rgba(0,0,0,0.06);
}

[data-theme="dark"] .punishment-title{
	border-bottom:1px solid rgba(255,255,255,0.10);
}

/* 内容滚动 */
.punishment-content{
	color:var(--dialog-muted);
	padding:14px 16px 10px;
	line-height:1.6;
	font-size:15px;
	overflow:auto;
	-webkit-overflow-scrolling:touch;
}

.punishment-content{
	-webkit-overflow-scrolling: touch;
	scrollbar-gutter: stable both-edges; 
}

.punishment-content{
	scrollbar-width: thin; 
	scrollbar-color: rgba(120,120,120,.55) rgba(0,0,0,0);
}

/* 3) Chromium / WebKit（Chrome / Edge / Safari）- 日间灰色 */
.punishment-content::-webkit-scrollbar{
	width: 10px;
}
.punishment-content::-webkit-scrollbar-track{
	background: transparent;
	border-radius: 999px;
}
.punishment-content::-webkit-scrollbar-thumb{
	border-radius: 999px;

	/* 日间模式：中性灰色 */
	background: linear-gradient(
		180deg,
		rgba(150,150,150,.55),
		rgba(100,100,100,.35)
	);


	border: 3px solid rgba(0,0,0,0);        
	background-clip: padding-box;

	/* 轻微高光 */
	box-shadow: inset 0 0 0 1px rgba(255,255,255,.18);
}
.punishment-content::-webkit-scrollbar-thumb:hover{
	background: linear-gradient(
		180deg,
		rgba(120,120,120,.72),
		rgba(80,80,80,.48)
	);
}
.punishment-content::-webkit-scrollbar-thumb:active{
	background: linear-gradient(
		180deg,
		rgba(100,100,100,.9),
		rgba(60,60,60,.62)
	);
}

/* 4) 夜间：紫色主题保持不变 */
[data-theme="dark"] .punishment-content{
	scrollbar-color: rgba(157,122,255,.60) rgba(255,255,255,0);
}
[data-theme="dark"] .punishment-content::-webkit-scrollbar-thumb{
	background: linear-gradient(
		180deg,
		rgba(157,122,255,.55),
		rgba(127,71,255,.35)
	);
	box-shadow: inset 0 0 0 1px rgba(255,255,255,.14);
}
[data-theme="dark"] .punishment-content::-webkit-scrollbar-thumb:hover{
	background: linear-gradient(
		180deg,
		rgba(157,122,255,.70),
		rgba(127,71,255,.48)
	);
}

/* 5) 触屏端优化 */
@media (pointer: coarse){
	.punishment-content::-webkit-scrollbar{
		width: 8px;
	}
	.punishment-content::-webkit-scrollbar-thumb{
		border-width: 2px;
	}
}

.dialog-buttons{
    margin-top: 10px;
	padding:12px 16px;
	border-top:1px solid rgba(0,0,0,0.06);
	display:flex;
	gap:10px;
	flex-direction:column;
}

[data-theme="dark"] .dialog-buttons{
	border-top:1px solid rgba(255,255,255,0.10);
}

/* 按钮 */
.punishment-button{
	background: rgba(255,255,255,0.7);
	color: var(--dialog-text);
	border: 1px solid rgba(0,0,0,0.10);
	padding: 10px 12px;
	border-radius: 10px;
	width: 80%;
    margin: 0 auto 10px;
	font-size: 16px;
	cursor: pointer;
	transition: transform .12s ease, background .2s ease, box-shadow .2s ease, opacity .2s ease;
	box-shadow: 0 2px 8px rgba(0,0,0,0.05);
	text-align:center;
	line-height:1.4;
}

[data-theme="dark"] .punishment-button{
	background: rgba(255,255,255,0.10);
	border: 1px solid rgba(255,255,255,0.14);
	color: rgba(255,255,255,0.92);
	box-shadow: 0 2px 10px rgba(0,0,0,0.25);
}

.punishment-button:hover{
	background: rgba(255,255,255,0.9);
	box-shadow: 0 4px 12px rgba(0,0,0,0.10);
}

[data-theme="dark"] .punishment-button:hover{
	background: rgba(255,255,255,0.16);
}

.punishment-button:active{ transform: scale(.98); }

/* 你那俩按钮 id 继续保留 */
#confirmRestart{
	background: rgba(100,230,150,0.78);
	color: #ffffff;
	border-color: rgba(0,0,0,0.08);
}
#cancelRestart{
	background: rgba(255,100,100,0.76);
	color: #ffffff;
	border-color: rgba(0,0,0,0.08);
}

/* ===== 抖一抖 ===== */
@keyframes shake{
	0%,100%{ transform: translateX(0); }
	20%{ transform: translateX(-5px); }
	40%{ transform: translateX(5px); }
	60%{ transform: translateX(-5px); }
	80%{ transform: translateX(5px); }
}

/* ===== 免责声明文案 ===== */
.legal-disclaimer{
	font-size:14px;
	line-height:1.6;
	color:var(--dialog-muted);
}
.legal-disclaimer strong{
	display:block;
	text-align:center;
	font-size:16px;
	color:var(--dialog-text);
	margin-bottom:6px;
}
.legal-disclaimer a{ font-weight:600; }

/* ===== 退出遮罩 ===== */
.exit-overlay{
	position:fixed;
	inset:0;
	background:rgba(255,255,255,0.95);
	backdrop-filter:blur(10px);
	display:flex;
	justify-content:center;
	align-items:center;
	z-index:9999;
}
[data-theme="dark"] .exit-overlay{
	background:rgba(10,10,14,0.92);
}

.exit-message{
	text-align:center;
	padding:30px;
	background:rgba(255,255,255,0.9);
	border-radius:12px;
	box-shadow:0 8px 32px rgba(0,0,0,0.1);
	animation: popIn .3s ease-out;
}
[data-theme="dark"] .exit-message{
	background:rgba(42,33,80,0.78);
	color:rgba(255,255,255,0.92);
}

/* ===== 棋盘/模式选择弹窗（沿用 punishment-dialog 结构也行，这里保留 board-dialog 兼容） ===== */
.board-dialog{
	width:min(92vw, 520px);
	max-height:min(86vh, 760px);

	background:var(--dialog-bg);
	border-radius:14px;
	box-shadow:0 12px 48px rgba(0,0,0,0.12);
	backdrop-filter:blur(24px);
	-webkit-backdrop-filter:blur(24px);
	border:1px solid var(--dialog-border);
	animation: popIn .3s cubic-bezier(0.22,0.61,0.36,1);

	display:flex;
	flex-direction:column;
	overflow:hidden;
}

.board-list{
	padding:14px 16px 10px;
	overflow:auto;
	-webkit-overflow-scrolling:touch;
}

.board-item{
	background: rgba(255,255,255,0.5);
	padding: 14px 18px;
	border-radius: 10px;
	margin-bottom: 12px;
	cursor: pointer;
	transition: transform .18s ease, background .18s ease, box-shadow .18s ease;
	border: 1px solid rgba(0,0,0,0.08);
	display:grid;
	grid-template-columns:1fr auto;
	gap:8px;
}

[data-theme="dark"] .board-item{
	background: rgba(255,255,255,0.08);
	border: 1px solid rgba(255,255,255,0.12);
}

.board-item:hover{
	background: rgba(255,255,255,0.8);
	transform: translateY(-2px);
	box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

[data-theme="dark"] .board-item:hover{
	background: rgba(255,255,255,0.14);
}

.board-info{ display:flex; flex-direction:column; }
.board-name{
	font-weight:700;
	color:var(--dialog-text);
	font-size:16px;
	white-space:nowrap;
}
.board-desc{
	color:var(--dialog-muted);
	font-size:13px;
	line-height:1.4;
	margin-top:4px;
}
.board-size{
	font-size:14px;
	color:var(--dialog-muted);
	white-space:nowrap;
	text-align:right;
	align-self:start;
}

/* ===== 临时提示 ===== */
.tmp-tip{
	position:fixed;
	left:50%;
	top:22px;
	transform:translate(-50%,-10px);
	padding:10px 14px;
	border-radius:999px;
	background:rgba(0,0,0,.65);
	color:#fff;
	font-size:13px;
	opacity:0;
	pointer-events:none;
	transition: opacity .18s ease, transform .18s ease;
	z-index:9999;
}
.tmp-tip.show{
	opacity:1;
	transform:translate(-50%,0);
}